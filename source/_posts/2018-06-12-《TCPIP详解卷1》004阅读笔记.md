---
title: 《TCPIP详解卷1》004阅读笔记
date: 2018-06-12 15:38:11
tags: [计算机网络,TCP/IP]
categories: TCP/IP
---

RFC 826 [Plummer 1982] 是ARP规范描述文档。
ARP（地址解析协议）
RARP（逆地址解析协议）
<br/>

ARP为IP地址到对应硬件地址之间提供动态映射，因为是自动完成的。
RARP被没有磁盘驱动器的系统使用，需要系统管理员手工设置。
<br/>

ARP发送一份称作ARP请求的以太网数据帧给以太网上的每个主机。称作广播。
<br/>

点对点链路不使用ARP。设置这些链路时，必须告知内核链路每一端的IP地址，而不需要硬件地址。
<br/>

ARP高效运行因为每个主机上都有一个ARP高速缓存
<br/>

#### ARP的分组格式

| 以太网目的地址 | 以太网源地址 | 帧类型        | 硬件类型       | 协议类型   | 硬件地址长度 | 协议地址长度 | op   | 发送端以太网地址 | 发送端IP地址 | 目的以太网地址 | 目的IP地址 |
| -------------- | ------------ | ------------- | -------------- | ---------- | ------------ | ------------ | ---- | ---------------- | ------------ | -------------- | ---------- |
| 6              | 6            | 2             | 2              | 2          | 1            | 1            | 2    | 6                | 4            | 6              | 4          |
| 全1            |              | 0x0806        | 1              | 0x0800     | 6 bytes      | 4 bytes      |      |                  |              |                |            |
| 广播地址       |              | ARP请求或应答 | 表示以太网地址 | 表示IP地址 | MAC地址长度  | IP地址长度   |      |                  |              |                |            |

- 目的地址：全1的特殊地址是广播地址，电缆上的所有以太网接口都要接收广播的数据帧。
- 操作字段（OP）：ARP请求（1）、ARP应答（2）、RARP请求（3）、RARP应答（4），必须字段，因为ARP请求和应答的帧类型字段相同。
  <br/>

#### ARP高速缓存超时设置

- BSD演变来的系统一般设置完整表项超时20分钟，不完整表项超时3分钟。
- 表项再次使用时，超时值重设为20分钟。
  <br/>

#### ARP代理

- 路由器相当于目的主机的代理，把分组从其他主机转发给它。
  <br/>

#### 免费ARP

- 是指发送ARP查找自己的IP地址。
- 两方面作用：
- 1. 验证IP是否冲突，一个主机能够通过它来确定是否还有一个主机设置了相同的IP地址。
- 1. 更换物理网卡，假设发送ARP的主机正好改变了物理地址，能够使用此方法通知网络中其他主机及时更新ARP缓存。
     <br/>

#### ARP命令

- arp -a 显示ARP高速缓存。
- arp -d 删除ARP高速缓存中某一项。
- arp -s 增加高速缓存中的内容，是永久性的，除非末尾加上关键字temp。