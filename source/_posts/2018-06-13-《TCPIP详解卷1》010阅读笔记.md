---
title: '「TCP/IP详解 卷1」010 阅读笔记'
date: 2018-06-13 20:05:37
tags: [计算机网络,TCP,IP]
categories: 《TCP/IP详解 卷1》
---

# 名词解释

| 缩写 | 英文全称 | 中文 |
| ---- | ------ | ---- |
| AS | Autonomous System | 自治系统 |
| IGP| Interior Gateway Protocol | 内部网关协议/域内选路协议 |
| EGP | Exterier Gateway Protocol | 外部网关协议/域内选路协议的分隔选路协议 |
| BGP | Border Gateway Protocol | 边界网关协议 |
| RIP | Routing Infomation Protocol | 选路信息协议 |
| OSPF | Open Shortest Path First | 开放最短路径优先协议 |
| CIDR | Classless Inter-Domain Routing | 无类别域间路由 |

- IGP 用于自治系统内。

- EGP 用于自治系统之间。

- BGP 意在取代 EGP。

# 动态选路

- 相邻路由器之间进行通信，告知对方每个路由器当前所连接的网络。

- 路由守护程序根据从相邻路由器收到的信息更新内核中的路由表。

- 随时间变化时，路由是由路由守护程序动态地增加或删除。

- 如果路由守护程序发现前往同一信宿存在多条路由，选择最佳路由加入内核路由表。

- 如果路由守护程序发现一条链路已经断开，删除受影响的路由或增加一条路由绕过。

- 每个自治系统由单个**实体**管理。==什么是实体？==

# RIP：选路信息协议

- 正式描述文件 RFC 1058 [Hedrick 1988a]。

- RIP 报文包含在 UDP 数据报中。

- RIP 的度量是以跳计数的。

- 最多携带 25 个路由。

## 度量

- 直接连接接口的跳数为 1。

- 一个路由器到一个网络有多条路由，路由器选择跳数最小的路由。

- 度量为 16 表示无路由到达该 IP 地址。

## 问题

- RIP 没有子网地址的概念。

- 路由器或链路发生故障后在稳定下来这段时间可能发生路由环路。

- 度量最大值限制了可以使用 RIP 的网络的大小。

# RIP 版本 2

- RFC 1388 [Malkin 1993a] 对 RIP 定义进行了扩充。

- 路由域字段：数据报的所有者。

- 选路标记字段：携带一个 EGP 和 BGP 的自治系统号。

- 子网掩码字段：应用于相应的 IP 地址。

- 下一站 IP 地址字段：指明发往目的 IP 地址的报文应该发往哪里。

- 除了支持广播，还支持多播。

# OSPF：开放最短路径优先

- RFC 1247 [Moy 1991] 对第 2 版 OSPF 进行了描述。

- OSPF 克服了 RIP 所有限制。

- 路由器不与临站交换距离信息，主动测试与临站相连的链路状态。

- 信息发给其他临站，临站将这些信息在自治系统中传播出去。

- 路由器接收这些链路状态信息，建立完整的路由表。

- 链路状态协议总是比距离向量协议稳定更快。

- OSPF 直接使用 IP，不使用 UDP 或 TCP。

- 优于 RIP 的特点：

    1. 可以对每个 IP 服务类型计算各自的路由集。

    2. 给每个接口指派一个无维数的费用。

    3. 同一个目的地址存在多个相同费用的路由时，平均分配流量。

    4. 支持子网，子网掩码与每个通告相连。

    5. 无编号网络。

    6. 简单鉴别机制。

    7. 采用多播而不是广播形式，减少系统负载。

# BGP：边界网关协议

- RFC 1267 [Lougheed and Rekhter 1991] 对第 3 版 BGP 进行描述。

- BGP 系统之间交换网络可到达信息，包括所必须经过的自治系统的所有路径。

- 使用 BGP 的一个目的是减少通过流量。

- 允许使用基于策略的选路。

- 使用 TCP 作为其传输层协议。

- BGP 是一个距离测量协议，列举了到每个目的地址的路由，排除了一些距离向量协议的问题。

- 定期发送 keepalive 报文给临站来监测 TCP 连接对端的链路或主机失败。

- 应用层的 keepalive 报文与 TCP 的 keepalive 报文选项相互独立。

# CIDR：无类型域间选路

- RFC 1518 [Rekher and Li 1993], RFC 1519 [Fuller et al. 1993] 对它描述。

- [Ford, Rekhter, and Braun 1993] 综述。

- 一个防止路由表膨胀的方法，也成为超网。

- 采用分配多个 IP 地址的方式，使许多表项总和成更少的数目

- 必须满足 3 种特性：

    1. IP地址必须具有相同的高位地址比特。

    2. 路由表和选路算法必须扩展成根据 32 bit IP 地址和 32 bit 掩码做出选路决策。

    3. 选路协议要有 32 bit 掩码。
